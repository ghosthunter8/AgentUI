import"./chunk-q3m7x063.js";import{i as d}from"./chunk-kma5vhbb.js";import"./chunk-shmck3jy.js";import"./chunk-4r2syzay.js";import{j as n,k as h}from"./chunk-j7wcbqec.js";class p extends n{static baseClass="au-dropdown";static cssFile="input";static observedAttributes=["placeholder","value","disabled"];#t=null;#e=null;#i=[];connectedCallback(){super.connectedCallback(),this.listen(window,"scroll",()=>this.#s(),{capture:!0,passive:!0}),this.listen(window,"resize",()=>this.#s(),{passive:!0})}disconnectedCallback(){super.disconnectedCallback(),this.#t?.remove()}render(){if(this.querySelector(".au-dropdown__trigger")&&this.#t)return;requestAnimationFrame(()=>this.#o())}#o(){if(this.querySelector(".au-dropdown__trigger")&&this.#t)return;let t=this.getAttribute("placeholder")||"Select",i=this.querySelectorAll("au-option"),l=this.querySelectorAll("option"),o=i.length>0?i:l;this.#i=Array.from(o).map((e)=>({value:e.getAttribute("value")||e.textContent.trim(),label:e.textContent.trim(),selected:e.hasAttribute("selected")})),this.#e=document.createElement("button"),this.#e.className="au-dropdown__trigger",this.#e.type="button";let r=d(t),u=`au-dropdown-menu-${Math.random().toString(36).slice(2,9)}`;this.#e.setAttribute("aria-haspopup","listbox"),this.#e.setAttribute("aria-expanded","false"),this.#e.setAttribute("aria-label",r),this.#e.setAttribute("popovertarget",u),this.#e.innerHTML=`
            <span class="au-dropdown__value">${r}</span>
            <svg class="au-dropdown__arrow" width="10" height="6" viewBox="0 0 10 6" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M1 1l4 4 4-4"/>
            </svg>
        `,this.listen(this.#e,"keydown",(e)=>{if(!this.hasAttribute("disabled")){if(e.key==="ArrowDown"||e.key==="Enter"||e.key===" ")e.preventDefault(),this.open()}}),this.innerHTML="",this.appendChild(this.#e),this.#t=document.createElement("div"),this.#t.id=u,this.#t.className="au-dropdown__menu",this.#t.setAttribute("popover","auto"),this.#t.setAttribute("role","listbox"),this.#t.tabIndex=-1,this.listen(this.#t,"toggle",(e)=>{if(e.newState==="open")this.classList.add("is-open"),this.#e?.setAttribute("aria-expanded","true"),this.#s(),requestAnimationFrame(()=>{let s=this.getAttribute("value");(s?this.#t.querySelector(`[data-value="${s}"]`):this.#t.firstChild)?.focus()});else this.classList.remove("is-open"),this.#e?.setAttribute("aria-expanded","false")}),this.listen(this.#t,"keydown",(e)=>this.#l(e)),this.#i.forEach((e)=>{let s=document.createElement("div");s.className="au-dropdown__option",s.setAttribute("data-value",e.value),s.textContent=e.label,s.setAttribute("role","option"),s.tabIndex=-1,this.listen(s,"click",()=>this.select(e.value,e.label)),this.#t.appendChild(s)}),this.appendChild(this.#t);let a=this.#i.find((e)=>e.selected);if(a)this.select(a.value,a.label)}#l(t){let i=Array.from(this.#t.querySelectorAll(".au-dropdown__option")),l=document.activeElement,o=i.indexOf(l);if(t.key==="ArrowDown")t.preventDefault(),(i[o+1]||i[0])?.focus();else if(t.key==="ArrowUp")t.preventDefault(),(i[o-1]||i[i.length-1])?.focus();else if(t.key==="Enter"||t.key===" "){if(t.preventDefault(),o>=0){let r=this.#i[o];this.select(r.value,r.label)}}else if(t.key==="Escape")t.preventDefault(),this.close(),this.#e?.focus()}#s(){if(!this.#t||!this.#e)return;let t=this.#e.getBoundingClientRect(),i=this.#t.scrollHeight||200,l=window.innerHeight-t.bottom-8<i&&t.top>i?t.top-i-4:t.bottom+4;Object.assign(this.#t.style,{position:"fixed",margin:"0",top:`${l}px`,left:`${t.left}px`,width:`${t.width}px`,minWidth:"160px",maxHeight:"280px"})}toggle(){if(this.#t?.matches(":popover-open"))this.close();else this.open()}open(){if(this.hasAttribute("disabled")||!this.#t)return;this.#t.showPopover()}close(){if(this.#t?.matches(":popover-open"))this.#t.hidePopover()}select(t,i){let l=this.querySelector(".au-dropdown__value");if(l)l.textContent=i;this.setAttribute("value",t),this.#t?.querySelectorAll(".au-dropdown__option").forEach((o)=>o.classList.toggle("is-active",o.getAttribute("data-value")===t)),this.emit("au-select",{value:t,label:i}),this.close()}get value(){return this.getAttribute("value")||""}set value(t){this.setAttribute("value",t)}}class c extends n{static baseClass="au-dropdown__option";connectedCallback(){super.connectedCallback(),this.setAttribute("role","option")}render(){}}h("au-dropdown",p);h("au-option",c);
