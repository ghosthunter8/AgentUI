import{c as n}from"./chunk-ak2n7z20.js";import"./chunk-namk58sd.js";import"./chunk-x9m15qkh.js";import"./chunk-tfr0ztm3.js";import"./chunk-nz1z0hn3.js";import{m as h,n as u,q as d}from"./chunk-nzeeasy9.js";class p extends h{static baseClass="au-dropdown";static cssFile="input";static observedAttributes=["placeholder","value","disabled"];#t=null;#e=null;#i=[];#s=!1;connectedCallback(){super.connectedCallback(),this.listen(window,"scroll",n(()=>this.#o(),16),{capture:!0,passive:!0}),this.listen(window,"resize",n(()=>this.#o(),100),{passive:!0})}disconnectedCallback(){super.disconnectedCallback(),this.#t?.remove()}attributeChangedCallback(t,i,o){if(!this.isConnected||i===o)return;if(t==="value"&&o!==null&&!this.#s){let s=this.#i.find((l)=>l.value===o);if(s){let l=this.querySelector(".au-dropdown__value");if(l)l.textContent=s.label;this.#t?.querySelectorAll(".au-dropdown__option").forEach((r)=>r.classList.toggle("is-active",r.getAttribute("data-value")===o))}}if(t==="disabled"){let s=this.querySelector(".au-dropdown__trigger");if(s)s.disabled=this.hasAttribute("disabled")}}render(){if(this.querySelector(".au-dropdown__trigger")&&this.#t)return;requestAnimationFrame(()=>this.#l())}#l(){if(this.querySelector(".au-dropdown__trigger")&&this.#t)return;let t=this.getAttribute("placeholder")||"Select",i=this.querySelectorAll("au-option"),o=this.querySelectorAll("option"),s=i.length>0?i:o;this.#i=Array.from(s).map((e)=>({value:e.getAttribute("value")||e.textContent.trim(),label:e.textContent.trim(),selected:e.hasAttribute("selected")})),this.#e=document.createElement("button"),this.#e.className="au-dropdown__trigger",this.#e.type="button";let l=`au-dropdown-menu-${Math.random().toString(36).slice(2,9)}`;this.#e.setAttribute("aria-haspopup","listbox"),this.#e.setAttribute("aria-expanded","false"),this.#e.setAttribute("aria-label",t),this.#e.setAttribute("popovertarget",l),this.#e.innerHTML=d`<span class="au-dropdown__value">${t}</span> <svg class="au-dropdown__arrow" width="10" height="6" viewBox="0 0 10 6" fill="none" stroke="currentColor" stroke-width="1.5"> <path d="M1 1l4 4 4-4"/> </svg>`,this.listen(this.#e,"keydown",(e)=>{if(!this.hasAttribute("disabled")){if(e.key==="ArrowDown"||e.key==="Enter"||e.key===" ")e.preventDefault(),this.open()}}),this.innerHTML="",this.appendChild(this.#e),this.#t=document.createElement("div"),this.#t.id=l,this.#t.className="au-dropdown__menu",this.#t.setAttribute("popover","auto"),this.#t.setAttribute("role","listbox"),this.#t.tabIndex=-1,this.listen(this.#t,"toggle",(e)=>{if(e.newState==="open")this.classList.add("is-open"),this.#e?.setAttribute("aria-expanded","true"),this.#o(),requestAnimationFrame(()=>{let a=this.getAttribute("value");(a?this.#t.querySelector(`[data-value="${a}"]`):this.#t.firstChild)?.focus()});else this.classList.remove("is-open"),this.#e?.setAttribute("aria-expanded","false")}),this.listen(this.#t,"keydown",(e)=>this.#a(e)),this.#i.forEach((e)=>{let a=document.createElement("div");a.className="au-dropdown__option",a.setAttribute("data-value",e.value),a.textContent=e.label,a.setAttribute("role","option"),a.tabIndex=-1,this.listen(a,"click",()=>this.select(e.value,e.label)),this.#t.appendChild(a)}),this.appendChild(this.#t);let r=this.#i.find((e)=>e.selected);if(r)this.select(r.value,r.label)}#a(t){let i=Array.from(this.#t.querySelectorAll(".au-dropdown__option")),o=document.activeElement,s=i.indexOf(o);if(t.key==="ArrowDown")t.preventDefault(),(i[s+1]||i[0])?.focus();else if(t.key==="ArrowUp")t.preventDefault(),(i[s-1]||i[i.length-1])?.focus();else if(t.key==="Enter"||t.key===" "){if(t.preventDefault(),s>=0){let l=this.#i[s];this.select(l.value,l.label)}}else if(t.key==="Escape")t.preventDefault(),this.close(),this.#e?.focus()}#o(){if(!this.#t||!this.#e)return;let t=this.#e.getBoundingClientRect(),i=this.#t.scrollHeight||200,o=window.innerHeight-t.bottom-8<i&&t.top>i?t.top-i-4:t.bottom+4;Object.assign(this.#t.style,{position:"fixed",margin:"0",top:`${o}px`,left:`${t.left}px`,width:`${t.width}px`,minWidth:"160px",maxHeight:"280px"})}toggle(){if(this.#t?.matches(":popover-open"))this.close();else this.open()}open(){if(this.hasAttribute("disabled")||!this.#t)return;this.#t.showPopover()}close(){if(this.#t?.matches(":popover-open"))this.#t.hidePopover()}select(t,i){this.#s=!0;let o=this.querySelector(".au-dropdown__value");if(o)o.textContent=i;this.setAttribute("value",t),this.#t?.querySelectorAll(".au-dropdown__option").forEach((s)=>s.classList.toggle("is-active",s.getAttribute("data-value")===t)),this.emit("au-select",{value:t,label:i}),this.close(),this.#s=!1}get value(){return this.getAttribute("value")||""}set value(t){this.setAttribute("value",t)}}class c extends h{static baseClass="au-dropdown__option";connectedCallback(){super.connectedCallback(),this.setAttribute("role","option")}render(){}}u("au-dropdown",p);u("au-option",c);
