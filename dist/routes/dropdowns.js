import"./chunk-cq3jhpch.js";import"./chunk-7bampcf2.js";import"./chunk-h1m0y636.js";import{i as n,j as h,m as u}from"./chunk-jxs5xaj9.js";class d extends n{static baseClass="au-dropdown";static cssFile="input";static observedAttributes=["placeholder","value","disabled"];#t=null;#e=null;#i=[];#s=!1;connectedCallback(){super.connectedCallback(),this.listen(window,"scroll",()=>this.#l(),{capture:!0,passive:!0}),this.listen(window,"resize",()=>this.#l(),{passive:!0})}disconnectedCallback(){super.disconnectedCallback(),this.#t?.remove()}attributeChangedCallback(t,i,l){if(!this.isConnected||i===l)return;if(t==="value"&&l!==null&&!this.#s){let s=this.#i.find((o)=>o.value===l);if(s){let o=this.querySelector(".au-dropdown__value");if(o)o.textContent=s.label;this.#t?.querySelectorAll(".au-dropdown__option").forEach((r)=>r.classList.toggle("is-active",r.getAttribute("data-value")===l))}}if(t==="disabled"){let s=this.querySelector(".au-dropdown__trigger");if(s)s.disabled=this.hasAttribute("disabled")}}render(){if(this.querySelector(".au-dropdown__trigger")&&this.#t)return;requestAnimationFrame(()=>this.#o())}#o(){if(this.querySelector(".au-dropdown__trigger")&&this.#t)return;let t=this.getAttribute("placeholder")||"Select",i=this.querySelectorAll("au-option"),l=this.querySelectorAll("option"),s=i.length>0?i:l;this.#i=Array.from(s).map((e)=>({value:e.getAttribute("value")||e.textContent.trim(),label:e.textContent.trim(),selected:e.hasAttribute("selected")})),this.#e=document.createElement("button"),this.#e.className="au-dropdown__trigger",this.#e.type="button";let o=`au-dropdown-menu-${Math.random().toString(36).slice(2,9)}`;this.#e.setAttribute("aria-haspopup","listbox"),this.#e.setAttribute("aria-expanded","false"),this.#e.setAttribute("aria-label",t),this.#e.setAttribute("popovertarget",o),this.#e.innerHTML=u`
            <span class="au-dropdown__value">${t}</span>
            <svg class="au-dropdown__arrow" width="10" height="6" viewBox="0 0 10 6" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M1 1l4 4 4-4"/>
            </svg>
        `,this.listen(this.#e,"keydown",(e)=>{if(!this.hasAttribute("disabled")){if(e.key==="ArrowDown"||e.key==="Enter"||e.key===" ")e.preventDefault(),this.open()}}),this.innerHTML="",this.appendChild(this.#e),this.#t=document.createElement("div"),this.#t.id=o,this.#t.className="au-dropdown__menu",this.#t.setAttribute("popover","auto"),this.#t.setAttribute("role","listbox"),this.#t.tabIndex=-1,this.listen(this.#t,"toggle",(e)=>{if(e.newState==="open")this.classList.add("is-open"),this.#e?.setAttribute("aria-expanded","true"),this.#l(),requestAnimationFrame(()=>{let a=this.getAttribute("value");(a?this.#t.querySelector(`[data-value="${a}"]`):this.#t.firstChild)?.focus()});else this.classList.remove("is-open"),this.#e?.setAttribute("aria-expanded","false")}),this.listen(this.#t,"keydown",(e)=>this.#a(e)),this.#i.forEach((e)=>{let a=document.createElement("div");a.className="au-dropdown__option",a.setAttribute("data-value",e.value),a.textContent=e.label,a.setAttribute("role","option"),a.tabIndex=-1,this.listen(a,"click",()=>this.select(e.value,e.label)),this.#t.appendChild(a)}),this.appendChild(this.#t);let r=this.#i.find((e)=>e.selected);if(r)this.select(r.value,r.label)}#a(t){let i=Array.from(this.#t.querySelectorAll(".au-dropdown__option")),l=document.activeElement,s=i.indexOf(l);if(t.key==="ArrowDown")t.preventDefault(),(i[s+1]||i[0])?.focus();else if(t.key==="ArrowUp")t.preventDefault(),(i[s-1]||i[i.length-1])?.focus();else if(t.key==="Enter"||t.key===" "){if(t.preventDefault(),s>=0){let o=this.#i[s];this.select(o.value,o.label)}}else if(t.key==="Escape")t.preventDefault(),this.close(),this.#e?.focus()}#l(){if(!this.#t||!this.#e)return;let t=this.#e.getBoundingClientRect(),i=this.#t.scrollHeight||200,l=window.innerHeight-t.bottom-8<i&&t.top>i?t.top-i-4:t.bottom+4;Object.assign(this.#t.style,{position:"fixed",margin:"0",top:`${l}px`,left:`${t.left}px`,width:`${t.width}px`,minWidth:"160px",maxHeight:"280px"})}toggle(){if(this.#t?.matches(":popover-open"))this.close();else this.open()}open(){if(this.hasAttribute("disabled")||!this.#t)return;this.#t.showPopover()}close(){if(this.#t?.matches(":popover-open"))this.#t.hidePopover()}select(t,i){this.#s=!0;let l=this.querySelector(".au-dropdown__value");if(l)l.textContent=i;this.setAttribute("value",t),this.#t?.querySelectorAll(".au-dropdown__option").forEach((s)=>s.classList.toggle("is-active",s.getAttribute("data-value")===t)),this.emit("au-select",{value:t,label:i}),this.close(),this.#s=!1}get value(){return this.getAttribute("value")||""}set value(t){this.setAttribute("value",t)}}class p extends n{static baseClass="au-dropdown__option";connectedCallback(){super.connectedCallback(),this.setAttribute("role","option")}render(){}}h("au-dropdown",d);h("au-option",p);
