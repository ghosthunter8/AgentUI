import{j as V}from"./chunk-bxze911z.js";import{n as Q,o as S}from"./chunk-765h5dy2.js";class W extends Q{static baseClass="au-dropdown";static cssFile="input";static observedAttributes=["placeholder","value","disabled"];#k=null;#q=null;#z=[];connectedCallback(){super.connectedCallback(),this.listen(window,"scroll",()=>this.#B(),{capture:!0,passive:!0}),this.listen(window,"resize",()=>this.#B(),{passive:!0})}disconnectedCallback(){super.disconnectedCallback(),this.#k?.remove()}render(){if(this.querySelector(".au-dropdown__trigger")&&this.#k)return;requestAnimationFrame(()=>this.#C())}#C(){if(this.querySelector(".au-dropdown__trigger")&&this.#k)return;let k=this.getAttribute("placeholder")||"Select",z=this.querySelectorAll("au-option"),G=this.querySelectorAll("option"),B=z.length>0?z:G;this.#z=Array.from(B).map((q)=>({value:q.getAttribute("value")||q.textContent.trim(),label:q.textContent.trim(),selected:q.hasAttribute("selected")})),this.#q=document.createElement("button"),this.#q.className="au-dropdown__trigger",this.#q.type="button";let F=V(k),U=`au-dropdown-menu-${Math.random().toString(36).slice(2,9)}`;this.#q.setAttribute("aria-haspopup","listbox"),this.#q.setAttribute("aria-expanded","false"),this.#q.setAttribute("aria-label",F),this.#q.setAttribute("popovertarget",U),this.#q.innerHTML=`
            <span class="au-dropdown__value">${F}</span>
            <svg class="au-dropdown__arrow" width="10" height="6" viewBox="0 0 10 6" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M1 1l4 4 4-4"/>
            </svg>
        `,this.listen(this.#q,"keydown",(q)=>{if(!this.hasAttribute("disabled")){if(q.key==="ArrowDown"||q.key==="Enter"||q.key===" ")q.preventDefault(),this.open()}}),this.innerHTML="",this.appendChild(this.#q),this.#k=document.createElement("div"),this.#k.id=U,this.#k.className="au-dropdown__menu",this.#k.setAttribute("popover","auto"),this.#k.setAttribute("role","listbox"),this.#k.tabIndex=-1,this.listen(this.#k,"toggle",(q)=>{if(q.newState==="open")this.classList.add("is-open"),this.#q?.setAttribute("aria-expanded","true"),this.#B(),requestAnimationFrame(()=>{let C=this.getAttribute("value");(C?this.#k.querySelector(`[data-value="${C}"]`):this.#k.firstChild)?.focus()});else this.classList.remove("is-open"),this.#q?.setAttribute("aria-expanded","false")}),this.listen(this.#k,"keydown",(q)=>this.#F(q)),this.#z.forEach((q)=>{let C=document.createElement("div");C.className="au-dropdown__option",C.setAttribute("data-value",q.value),C.textContent=q.label,C.setAttribute("role","option"),C.tabIndex=-1,this.listen(C,"click",()=>this.select(q.value,q.label)),this.#k.appendChild(C)}),this.appendChild(this.#k);let J=this.#z.find((q)=>q.selected);if(J)this.select(J.value,J.label)}#F(k){let z=Array.from(this.#k.querySelectorAll(".au-dropdown__option")),G=document.activeElement,B=z.indexOf(G);if(k.key==="ArrowDown")k.preventDefault(),(z[B+1]||z[0])?.focus();else if(k.key==="ArrowUp")k.preventDefault(),(z[B-1]||z[z.length-1])?.focus();else if(k.key==="Enter"||k.key===" "){if(k.preventDefault(),B>=0){let F=this.#z[B];this.select(F.value,F.label)}}else if(k.key==="Escape")k.preventDefault(),this.close(),this.#q?.focus()}#B(){if(!this.#k||!this.#q)return;let k=this.#q.getBoundingClientRect(),z=this.#k.scrollHeight||200,F=window.innerHeight-k.bottom-8<z&&k.top>z?k.top-z-4:k.bottom+4;Object.assign(this.#k.style,{position:"fixed",margin:"0",top:`${F}px`,left:`${k.left}px`,width:`${k.width}px`,minWidth:"160px",maxHeight:"280px"})}toggle(){if(this.#k?.matches(":popover-open"))this.close();else this.open()}open(){if(this.hasAttribute("disabled")||!this.#k)return;this.#k.showPopover()}close(){if(this.#k?.matches(":popover-open"))this.#k.hidePopover()}select(k,z){let G=this.querySelector(".au-dropdown__value");if(G)G.textContent=z;this.setAttribute("value",k),this.#k?.querySelectorAll(".au-dropdown__option").forEach((B)=>B.classList.toggle("is-active",B.getAttribute("data-value")===k)),this.emit("au-select",{value:k,label:z}),this.close()}get value(){return this.getAttribute("value")||""}set value(k){this.setAttribute("value",k)}}class X extends Q{static baseClass="au-dropdown__option";connectedCallback(){super.connectedCallback(),this.setAttribute("role","option")}render(){}}S("au-dropdown",W);S("au-option",X);export{X as AuOption,W as AuDropdown};
