import{j as W,k as O,l as j}from"./chunk-qe84fbdd.js";import{o as I}from"./chunk-0f7ph7sp.js";import{p as U,q as E}from"./chunk-aeetm00j.js";function D(F,G={}){let J=G.persist?`agentui:${G.persist}`:null,P={...F},L=new Map,Q=new Set,Y=!1,M=new Map;if(J)try{let z=typeof localStorage<"u"?localStorage.getItem(J):null;if(z){let q=JSON.parse(z);if(q&&typeof q==="object"){for(let B of Object.keys(F))if(B in q)P[B]=q[B]}}}catch(z){}function $(z,q,B){let H=L.get(z);if(H)for(let Z of H)Z(q,B);for(let Z of Q)Z(z,q,B)}function R(){if(!J)return;try{if(typeof localStorage<"u")localStorage.setItem(J,JSON.stringify(P))}catch(z){}}let x=new Proxy(P,{get(z,q){return z[q]},set(z,q,B){let H=z[q];if(Object.is(H,B))return!0;if(z[q]=B,Y){if(!M.has(q))M.set(q,{oldVal:H});M.get(q).newVal=B}else $(q,B,H),R();return!0}});return{state:x,subscribe(z,q){if(z==="*")return Q.add(q),()=>Q.delete(q);if(!L.has(z))L.set(z,new Set);return L.get(z).add(q),()=>{let B=L.get(z);if(B){if(B.delete(q),B.size===0)L.delete(z)}}},batch(z){Y=!0,M.clear();try{z()}finally{Y=!1;for(let[q,{newVal:B,oldVal:H}]of M)if(!Object.is(B,H))$(q,B,H);if(M.clear(),M.size===0)R()}},getState(){return{...P}},setState(z){for(let[q,B]of Object.entries(z))x[q]=B},destroy(){L.clear(),Q.clear()}}}var N=D({current:"light",preference:"auto"},{persist:"au-theme"}),X={set(F){if(F==="auto"){let G=window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.setAttribute("data-theme",G?"dark":"light")}else document.documentElement.setAttribute("data-theme",F);N.state.preference=F,N.state.current=document.documentElement.getAttribute("data-theme"),W.emit(O.THEME_CHANGE,{theme:F})},get(){return document.documentElement.getAttribute("data-theme")||"light"},toggle(){let F=this.get();this.set(F==="dark"?"light":"dark")},init(){let F=typeof localStorage<"u"?localStorage.getItem("au-theme"):null;if(F&&!N.state.preference){this.set(F);try{localStorage.removeItem("au-theme")}catch(J){}return}let G=N.state.preference;if(G&&G!=="auto")this.set(G);else if(F){this.set(F);try{localStorage.removeItem("au-theme")}catch(J){}}else this.set("auto");this._mql=window.matchMedia("(prefers-color-scheme: dark)"),this._onMqlChange=(J)=>{if(N.state.preference==="auto")document.documentElement.setAttribute("data-theme",J.matches?"dark":"light")},this._mql.addEventListener("change",this._onMqlChange)},destroy(){if(this._mql&&this._onMqlChange)this._mql.removeEventListener("change",this._onMqlChange),this._mql=null,this._onMqlChange=null},get _store(){return N}};if(typeof window<"u")X.init();class A extends U{static baseClass="au-theme-toggle";connectedCallback(){super.connectedCallback(),this.listen(this,"click",()=>X.toggle()),W.on(O.THEME_CHANGE,()=>this.#q())}render(){this.innerHTML=I`
            <button class="au-theme-toggle__button" aria-label="Toggle theme">
                <span class="au-theme-toggle__icon"></span>
            </button>
        `,this.#q()}#q(){let F=X.get()==="dark",G=this.querySelector(".au-theme-toggle__icon");if(G)G.textContent=F?"☀️":"\uD83C\uDF19"}}E("au-theme-toggle",A);j("au-theme-toggle",{signals:[O.THEME_CHANGE],options:{themes:["light","dark"],emits:["click"]},description:"Theme toggle button that switches between light/dark modes"});export{A as AuThemeToggle};
