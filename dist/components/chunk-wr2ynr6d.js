var W=typeof window<"u"?window:globalThis,D=["ui:toast","ui:modal","ui:theme","ui:tabs","ui:dropdown","ui:form","ui:grid","ui:stack","ui:virtual-list"],U={type:"ui-framework",version:"0.1.144",description:"AI-Optimized UI Framework - Web Components Edition"};class ${#j=new Map;#q=new Map;#z=new Set;#F=new Set;#J=100;#Q=!1;#V=Date.now();peerId;capabilities;meta;constructor(j={}){this.peerId=j.peerId??"default",this.capabilities=j.capabilities??[],this.meta=j.meta??{},this.#Q=j.debug??!1}on(j,q){if(!this.#j.has(j))this.#j.set(j,new Set);let z=q;this.#j.get(j).add(z);let J=this.#j.get(j).size;if(J>this.#J)console.warn(`[AgentUI] Possible event leak: "${j}" has ${J} listeners (maxListeners: ${this.#J}). Use setMaxListeners() to increase.`);return{unsubscribe:()=>this.#j.get(j)?.delete(z)}}off(j,q){this.#j.get(j)?.delete(q)}emitSync(j,q){let z={event:j,data:q};for(let Q of this.#F)z=Q(z,{event:j})??z;let J=z;for(let Q of this.#z)J=Q(J,{event:j})??J;let X=this.#j.get(j);if(X)for(let Q of X)Q(J);for(let[Q,x]of this.#j)if(Q.endsWith("*")&&j.startsWith(Q.slice(0,-1))&&Q!==j)for(let K of x)K(J)}async emit(j,q){return this.emitSync(j,q),{delivered:!0,event:j}}signal(j,q){this.emitSync(j,q)}hasListeners(j){return(this.#j.get(j)?.size??0)>0}handle(j,q){return this.#q.set(j,q),{unsubscribe:()=>this.#q.delete(j)}}unhandle(j){this.#q.delete(j)}async request(j,q,z){let J=this.#q.get(q);if(!J)throw Error(`No handler for '${q}'`);return J(z)}async broadcastRequest(j,q){return this.request(this.peerId,j,q)}addInboundHook(j){return this.#z.add(j),()=>this.#z.delete(j)}addOutboundHook(j){return this.#F.add(j),()=>this.#F.delete(j)}setMaxListeners(j){this.#J=j}get debug(){return this.#Q}get peers(){return[]}get peerCount(){return 0}healthCheck(){return{status:"healthy",peerId:this.peerId,uptime:Date.now()-this.#V,listeners:this.#j.size,handlers:this.#q.size}}destroy(){this.#j.clear(),this.#q.clear(),this.#z.clear(),this.#F.clear()}}if(!W.__AGENTUI_BUS__)W.__AGENTUI_BUS__=new $({peerId:"agentui",capabilities:D,meta:U});var F=W.__AGENTUI_BUS__,Z="__AGENTUI_COMPONENT_REGISTRY__";if(!W[Z])W[Z]=new Map;var w=W[Z],V=new WeakMap,O={on(j,q){let z=(X)=>{q(X.data??X)};if(!V.has(q))V.set(q,new Map);V.get(q).set(j,z);let J=F.on(j,z);return()=>{J.unsubscribe(),V.get(q)?.delete(j)}},once(j,q){let z=this.on(j,(J)=>{z(),q(J)})},off(j,q){let z=V.get(q)?.get(j);if(z)F.off(j,z),V.get(q)?.delete(j)},emit(j,q){return F.emitSync(j,q)},async emitAsync(j,q){return F.emit(j,q)},signal(j,q){F.signal(j,q)},async request(j,q,z){return F.request(j,q,z)},async broadcastRequest(j,q){return F.broadcastRequest(j,q)},handle(j,q){return F.handle(j,q)},unhandle(j){F.unhandle(j)},destroy(){F.destroy()},setMaxListeners(j){F.setMaxListeners(j)},get peerId(){return F.peerId},get peers(){return F.peers},get peerCount(){return F.peerCount},hasListeners(j){return F.hasListeners(j)},get raw(){return F}},Y={TOAST_SHOW:"ui:toast:show",TOAST_DISMISS:"ui:toast:dismiss",MODAL_OPEN:"ui:modal:open",MODAL_CLOSE:"ui:modal:close",THEME_CHANGE:"ui:theme:change",TAB_CHANGE:"ui:tab:change",DROPDOWN_SELECT:"ui:dropdown:select",FORM_SUBMIT:"ui:form:submit",FORM_VALIDATE:"ui:form:validate"};var G=(j,q)=>{w.set(j,{...q,registeredAt:Date.now()})};
export{O as j,Y as k,G as l};
