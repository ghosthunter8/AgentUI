import{o as K}from"./chunk-0f7ph7sp.js";import{p as I,q as J}from"./chunk-gkgym1ts.js";var z=[];function Q(){return[...z]}function S(){z.length=0}class L extends I{static baseClass="au-error-boundary";static observedAttributes=["fallback"];#q=!1;#w=null;#z="";#x=null;connectedCallback(){super.connectedCallback(),this.#z=this.innerHTML,this.listen(this,"error",this.#D.bind(this)),this.#I()}disconnectedCallback(){super.disconnectedCallback(),window.onerror=this.#x}#I(){this.#x=window.onerror,window.onerror=(w,q,x,M,D)=>{if(this.#J(D))return this.#D({detail:{error:D,message:w}}),!0;if(this.#x)return this.#x(w,q,x,M,D);return!1}}#J(w){if(!w?.stack)return!1;return Array.from(this.querySelectorAll("*")).filter((x)=>x.tagName.startsWith("AU-")).map((x)=>x.tagName.toLowerCase()).some((x)=>w.stack.includes(x))}#D(w){let q=w?.detail?.error||w?.error||w;if(this.#q)return;if(this.#q=!0,this.#w=q,z.push({timestamp:Date.now(),component:this.id||"au-error-boundary",error:{message:q?.message||String(q),stack:q?.stack,name:q?.name},context:{originalContent:this.#z.slice(0,200),parentUrl:window.location.href}}),z.length>50)z.shift();this.#K(),this.emit("au-error",{error:q,boundary:this,recover:()=>this.recover()}),w?.stopPropagation?.()}#K(){let w=this.getAttribute("fallback");if(w){let q=document.createElement("div");q.className="au-error-boundary__fallback",q.setAttribute("role","alert"),q.textContent=w,this.innerHTML="",this.appendChild(q)}else this.innerHTML=K`
                <div class="au-error-boundary__fallback" role="alert" aria-live="polite">
                    <au-icon name="error" style="--au-icon-size: 48px; color: var(--md-sys-color-error);"></au-icon>
                    <p class="au-error-boundary__title">Something went wrong</p>
                    <p class="au-error-boundary__message">${this.#w?.message||"An unexpected error occurred"}</p>
                    <au-button variant="outlined" onclick="this.closest('au-error-boundary').recover()">
                        Try Again
                    </au-button>
                </div>
            `;this.classList.add("has-error")}render(){this.style.display="block"}recover(){this.#q=!1,this.#w=null,this.classList.remove("has-error"),this.innerHTML=this.#z,this.emit("au-recover")}get hasError(){return this.#q}get error(){return this.#w}}J("au-error-boundary",L);export{Q as getErrors,S as clearErrors,L as AuErrorBoundary};
