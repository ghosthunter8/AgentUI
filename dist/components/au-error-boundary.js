import{s as H}from"./chunk-kfvs9a30.js";import{t as z,u as D}from"./chunk-j65yb8cs.js";var x=[];function L(){return[...x]}function M(){x.length=0}class I extends z{static baseClass="au-error-boundary";static observedAttributes=["fallback"];#p=!1;#q=null;#w="";connectedCallback(){super.connectedCallback(),this.#w=this.innerHTML,this.listen(this,"error",this.#x.bind(this)),this.listen(window,"error",(p)=>{if(this.#z(p.error))this.#x({detail:{error:p.error,message:p.message}}),p.preventDefault()})}#z(p){if(!p?.stack)return!1;return Array.from(this.querySelectorAll("*")).filter((w)=>w.tagName.startsWith("AU-")).map((w)=>w.tagName.toLowerCase()).some((w)=>p.stack.includes(w))}#x(p){let q=p?.detail?.error||p?.error||p;if(this.#p)return;if(this.#p=!0,this.#q=q,x.push({timestamp:Date.now(),component:this.id||"au-error-boundary",error:{message:q?.message||String(q),stack:q?.stack,name:q?.name},context:{originalContent:this.#w.slice(0,200),parentUrl:window.location.href}}),x.length>50)x.shift();this.#D(),this.emit("au-error",{error:q,boundary:this,recover:()=>this.recover()}),p?.stopPropagation?.()}#D(){let p=this.getAttribute("fallback");if(p){let q=document.createElement("div");q.className="au-error-boundary__fallback",q.setAttribute("role","alert"),q.textContent=p,this.innerHTML="",this.appendChild(q)}else this.innerHTML=H`<div class="au-error-boundary__fallback" role="alert" aria-live="polite"> <au-icon name="error" style="--au-icon-size: 48px; color: var(--md-sys-color-error);"></au-icon> <p class="au-error-boundary__title">Something went wrong</p> <p class="au-error-boundary__message">${this.#q?.message||"An unexpected error occurred"}</p> <au-button variant="outlined" onclick="this.closest('au-error-boundary').recover()"> Try Again </au-button> </div>`;this.classList.add("has-error")}render(){this.style.display="block"}recover(){this.#p=!1,this.#q=null,this.classList.remove("has-error"),this.innerHTML=this.#w,this.emit("au-recover")}get hasError(){return this.#p}get error(){return this.#q}}D("au-error-boundary",I);export{L as getErrors,M as clearErrors,I as AuErrorBoundary};
