import{b as J}from"./chunk-br0mth89.js";import{s as O}from"./chunk-kfvs9a30.js";import{u as N}from"./chunk-xm6c90d2.js";var G=null;async function U(k,z={}){let{title:y="Confirm",confirmText:F="Confirm",cancelText:H="Cancel",variant:I="primary"}=z;if(G)G.remove();return new Promise((K)=>{let q=document.createElement("au-confirm");q.setAttribute("title",y),q.setAttribute("message",k),q.setAttribute("confirm-text",F),q.setAttribute("cancel-text",H),q.setAttribute("variant",I),q.addEventListener("au-confirm",()=>{q.remove(),G=null,K(!0)}),q.addEventListener("au-cancel",()=>{q.remove(),G=null,K(!1)}),G=q,document.body.appendChild(q),q.open()})}class P extends J{static baseClass="au-confirm";static cssFile="overlays";static observedAttributes=["title","message","confirm-text","cancel-text","variant","open","size"];#k=null;disconnectedCallback(){if(this.#k?.open)document.body.style.overflow="";super.disconnectedCallback()}connectedCallback(){if(!this.hasAttribute("data-rendered"))this.setAttribute("data-rendered","true");Object.getPrototypeOf(J.prototype).connectedCallback.call(this)}render(){if(this.querySelector("dialog")){this.#k=this.querySelector("dialog"),this.#q();return}let k=this.attr("title","Confirm"),z=this.attr("message","Are you sure?"),y=this.attr("confirm-text","Confirm"),F=this.attr("cancel-text","Cancel"),I=this.attr("variant","primary")==="danger"?"danger":"filled";this.innerHTML=O`<dialog class="au-confirm__dialog"> <h3 class="au-confirm__title">${k}</h3> <p class="au-confirm__message">${z}</p> <div class="au-confirm__actions"> <au-button variant="text" data-action="cancel">${F}</au-button> <au-button variant="${I}" data-action="confirm">${y}</au-button> </div> </dialog>`,this.#k=this.querySelector("dialog"),this.#q()}handleAction(k,z,y){if(k==="cancel")this.cancel();else if(k==="confirm")this.confirm()}#q(){if(this.#k=this.querySelector("dialog"),!this.#k)return;this.listen(this.#k,"close",()=>{this.removeAttribute("open"),this.classList.remove("is-open","is-visible"),document.body.style.overflow=""}),this.listen(this.#k,"cancel",(k)=>{k.preventDefault(),this.cancel()}),this.listen(this.#k,"click",(k)=>{if(k.target===this.#k)this.cancel()})}update(k,z,y){if(k==="open"){if(z!==null)this.#y()}}#y(){if(!this.#k||this.#k.open)return;this.classList.add("is-open"),this.#k.showModal(),document.body.style.overflow="hidden";let k=this.querySelector('[data-action="confirm"]');if(k)requestAnimationFrame(()=>{requestAnimationFrame(()=>k.focus())});requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.classList.add("is-visible")})})}open(){this.setAttribute("open","")}close(){if(!this.#k)return;this.classList.remove("is-visible");let k=!1,z=()=>{if(k)return;if(k=!0,this.#k&&this.#k.open)this.#k.close();this.removeAttribute("open"),this.classList.remove("is-open"),document.body.style.overflow=""},y=this.#k,F=(H)=>{if(H.target===y)y.removeEventListener("transitionend",F),z()};this.listen(y,"transitionend",F),this.setTimeout(()=>{y.removeEventListener("transitionend",F),z()},200)}confirm(){this.close(),this.emit("au-confirm")}cancel(){this.close(),this.emit("au-cancel")}}N("au-confirm",P);export{U as auConfirm,P as AuConfirm};
