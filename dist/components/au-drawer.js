import{a as L}from"./chunk-5xbxmtgg.js";import{p as P,q as Q}from"./chunk-4tm8p8jh.js";class N{#B=[];#G=!1;constructor(){this.#H()}#H(){if(this.#G||typeof window>"u")return;document.addEventListener("keydown",(B)=>{if(B.key==="Escape"&&this.#B.length>0)B.preventDefault(),B.stopPropagation(),this.#B[this.#B.length-1].callback()}),this.#G=!0}pushEscapeHandler(B,G){let H={element:B,callback:G};return this.#B.push(H),()=>{let J=this.#B.indexOf(H);if(J>-1)this.#B.splice(J,1)}}isTopmost(B){if(this.#B.length===0)return!1;return this.#B[this.#B.length-1].element===B}get stackDepth(){return this.#B.length}}var O=new N;class T extends P{static get observedAttributes(){return["mode","open","expand-on-hover","position"]}static baseClass="au-drawer";static cssFile="drawer";static useContainment=!1;constructor(){super();this._currentMode="expanded",this._isHovering=!1,this._unsubscribe=null}get mode(){return this.getAttribute("mode")||"auto"}set mode(B){this.setAttribute("mode",B)}get open(){return this.hasAttribute("open")}set open(B){this.toggleAttribute("open",Boolean(B))}get expandOnHover(){return this.hasAttribute("expand-on-hover")}set expandOnHover(B){this.toggleAttribute("expand-on-hover",Boolean(B))}get position(){return this.getAttribute("position")||"start"}set position(B){this.setAttribute("position",B)}connectedCallback(){if(!this._slotsCaptured)this._slots={header:this.querySelector('[slot="header"]'),footer:this.querySelector('[slot="footer"]'),default:Array.from(this.children).filter((B)=>!B.hasAttribute("slot"))},this._slotsCaptured=!0;super.connectedCallback(),this._setupBreakpointListener(),this._setupListeners(),this._forceUpdateMode()}_getInitialMode(){let B=this.mode,G=L.isCompact,H=L.isMedium;if(B==="permanent")return"expanded";else if(B==="temporary")return"hidden";else if(B==="rail")return G?"hidden":"rail";else if(G)return"hidden";else if(H)return"rail";else return"expanded"}_forceUpdateMode(){this._currentMode=this._getInitialMode(),this._applyMode()}disconnectedCallback(){if(super.disconnectedCallback(),this._unsubscribe)this._unsubscribe(),this._unsubscribe=null;this._unsubEsc?.(),this._unsubEsc=null}attributeChangedCallback(B,G,H){if(!this.isConnected)return;if(B==="open")this._updateOpenState();else if(B==="mode")this._updateMode()}_setupBreakpointListener(){this._unsubscribe=L.subscribe(()=>{this._updateMode()})}_updateMode(){let B=this.mode,G=L.isCompact,H=L.isMedium,J;if(B==="permanent")J="expanded";else if(B==="temporary")J="hidden";else if(B==="rail")J=G?"hidden":"rail";else if(G)J="hidden";else if(H)J="rail";else J="expanded";if(J!==this._currentMode)this._currentMode=J,this._applyMode()}_applyMode(){let B=this.querySelector(".au-drawer-nav");if(!B)return;if(B.classList.remove("au-drawer-mode-expanded","au-drawer-mode-rail","au-drawer-mode-hidden"),B.classList.add(`au-drawer-mode-${this._currentMode}`),this.querySelectorAll("au-drawer-item").forEach((H)=>{if(this._currentMode==="rail"&&!this._isHovering)H.setAttribute("hide-label","");else H.removeAttribute("hide-label")}),this._currentMode!=="hidden")this.open=!1,this._hideScrim(),this._unsubEsc?.(),this._unsubEsc=null;else if(!this.open)this._hideScrim()}_setupListeners(){let B=this.querySelector(".au-drawer-scrim");if(B)this.listen(B,"click",()=>{this.open=!1});let G=this.querySelector(".au-drawer-nav");if(G&&this.expandOnHover)this.listen(G,"mouseenter",()=>{if(this._currentMode==="rail")this._isHovering=!0,G.classList.add("au-drawer-expanded-hover"),this._applyMode()}),this.listen(G,"mouseleave",()=>{if(this._currentMode==="rail")this._isHovering=!1,G.classList.remove("au-drawer-expanded-hover"),this._applyMode()});this.listen(this,"au-nav-select",(H)=>{if(this._currentMode==="hidden"&&this.open)this.open=!1;this._updateActiveItem(H.detail.item)}),this._unsubEsc=null}_updateActiveItem(B){this.querySelectorAll("au-drawer-item").forEach((H)=>{H.active=H===B})}_updateOpenState(){let B=this.querySelector(".au-drawer-nav");if(this.open){if(B?.classList.add("au-drawer-open"),this._currentMode==="hidden")this._showScrim(),this._unsubEsc=O.pushEscapeHandler(this,()=>{this.open=!1})}else B?.classList.remove("au-drawer-open"),this._hideScrim(),this._unsubEsc?.(),this._unsubEsc=null}_showScrim(){let B=this.querySelector(".au-drawer-scrim");if(B)B.classList.add("au-drawer-scrim-visible")}_hideScrim(){let B=this.querySelector(".au-drawer-scrim");if(B)B.classList.remove("au-drawer-scrim-visible")}toggle(){this.open=!this.open}render(){this.innerHTML="";let B=document.createElement("div");B.className="au-drawer-scrim",this.appendChild(B);let G=document.createElement("nav");G.className=`au-drawer-nav au-drawer-mode-${this._getInitialMode()}`,G.setAttribute("role","navigation");let H=document.createElement("div");if(H.className="au-drawer-header",this._slots.header)H.appendChild(this._slots.header);G.appendChild(H);let J=document.createElement("div");if(J.className="au-drawer-content",J.setAttribute("role","menu"),this._slots.default)this._slots.default.forEach((U)=>J.appendChild(U));if(G.appendChild(J),this._slots.footer)G.appendChild(this._slots.footer);this.appendChild(G)}}Q("au-drawer",T);export{T as AuDrawer};
