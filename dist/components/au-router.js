import{j as V}from"./chunk-bxze911z.js";import{n as O,o as Q}from"./chunk-n8w89ctd.js";class W extends O{static baseClass="au-router";static observedAttributes=["base","default"];#q=new Map;#v=null;connectedCallback(){super.connectedCallback(),this.listen(window,"hashchange",()=>this.#w()),this.#w()}render(){this.innerHTML='<div class="au-router__content"></div>'}get#z(){return this.attr("base","/app/pages")}get#B(){return this.attr("default","home")}get#F(){return this.querySelector(".au-router__content")}async#w(){let q=window.location.hash.slice(1)||this.#B;if(q===this.#v)return;this.#v=q,this.emit("au-route-change",{route:q}),await this.#G(q)}async#G(q){let w=this.#F;if(!w)return;w.innerHTML="<au-spinner></au-spinner>";try{if(this.#q.has(q)){w.innerHTML=this.#q.get(q),this.emit("au-page-loaded",{route:q});return}let v=`${this.#z}/${q}.html`,B=await fetch(v);if(!B.ok)throw Error(`Page not found: ${q}`);let F=await B.text(),z=new DOMParser().parseFromString(F,"text/html").querySelector("au-page");if(z){let G=z.querySelector("template"),J=G?G.innerHTML:z.innerHTML;this.#q.set(q,J),w.innerHTML=J;let K=z.querySelector('script[type="x-dependencies"]');if(K)await this.#J(K.textContent);let N=z.getAttribute("title");if(N)document.title=`${N} | AgentUI`}else w.innerHTML=F;this.emit("au-page-loaded",{route:q})}catch(v){w.innerHTML=`
        <au-alert variant="error">
          <strong>Page not found</strong>
          <p>Could not load page: ${V(q)}</p>
        </au-alert>
      `,this.emit("au-page-error",{route:q,error:v})}}async#J(q){let w=q.split(/[\n,]/).map((v)=>v.trim()).filter((v)=>v&&v.startsWith("au-"));for(let v of w){if(customElements.get(v))continue;try{await import(`/dist/components/${v}.js`)}catch(B){console.warn(`[au-router] Could not load: ${v}`,B)}}}navigate(q){window.location.hash=q}get currentRoute(){return this.#v}}Q("au-router",W);export{W as AuRouter};
