import{j as Y}from"./chunk-wr2ynr6d.js";import{o as W}from"./chunk-0f7ph7sp.js";import{p as U,q as V}from"./chunk-4tm8p8jh.js";class Z extends U{static baseClass="au-router";static observedAttributes=["base","default"];#w=new Map;#q=null;connectedCallback(){super.connectedCallback(),this.listen(window,"hashchange",()=>this.#B()),this.#B()}render(){this.innerHTML='<div class="au-router__content"></div>'}get#F(){return this.attr("base","/app/pages")}get#G(){return this.attr("default","home")}get#J(){return this.querySelector(".au-router__content")}async#B(){let q=window.location.hash.slice(1)||this.#G;if(q===this.#q)return;let B=this.#q;this.#q=q,this.emit("au-route-change",{route:q}),Y.emit("au:route-change",{route:q,previous:B}),await this.#K(q)}async#K(q){let B=this.#J;if(!B)return;B.innerHTML="<au-spinner></au-spinner>";try{if(this.#w.has(q)){B.innerHTML=this.#w.get(q),this.emit("au-page-loaded",{route:q});return}let w=`${this.#F}/${q}.html`,G=await fetch(w);if(!G.ok)throw Error(`Page not found: ${q}`);let J=await G.text(),F=new DOMParser().parseFromString(J,"text/html").querySelector("au-page");if(F){let K=F.querySelector("template"),N=K?K.innerHTML:F.innerHTML;this.#w.set(q,N),B.innerHTML=N;let O=F.querySelector('script[type="x-dependencies"]');if(O)await this.#N(O.textContent);let Q=F.getAttribute("title");if(Q)document.title=`${Q} | AgentUI`}else B.textContent=J;this.emit("au-page-loaded",{route:q})}catch(w){B.innerHTML=W`
        <au-alert variant="error">
          <strong>Page not found</strong>
          <p>Could not load page: ${q}</p>
        </au-alert>
      `,this.emit("au-page-error",{route:q,error:w})}}async#N(q){let B=q.split(/[\n,]/).map((w)=>w.trim()).filter((w)=>w&&w.startsWith("au-"));for(let w of B){if(customElements.get(w))continue;try{await import(`/dist/components/${w}.js`)}catch(G){console.warn(`[au-router] Could not load: ${w}`,G)}}}navigate(q){window.location.hash=q}get currentRoute(){return this.#q}}V("au-router",Z);export{Z as AuRouter};
